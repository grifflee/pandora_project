<!DOCTYPE html> 
<html> 
<head>
    <title>RDA Weather Systems</title>
    
    <style>
        body { 
            background-color: black; 
            color: #0b500b; 
            font-family: monospace; 
            text-align: center; 
            margin-top: 50px;
            padding: 20px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: background-image 0.5s ease-in-out;
        }
        
        #result {
            background-color: white;
            color: black;
            border: 2px solid #00ff00;
            padding: 20px;
            margin: 20px auto;
            max-width: 600px;
            min-height: 150px;
            white-space: pre-line;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .status {
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 10px;
            padding: 5px;
        }
        
        button { 
            background-color: #004400; 
            color: #00ff00; 
            border: 2px solid #00ff00; 
            padding: 12px 24px; 
            cursor: pointer;
            font-family: monospace;
            font-size: 14px;
            margin: 10px;
            transition: all 0.3s ease;
        }
        
        button:hover {
            background-color: #00ff00; 
            color: black;
            transform: scale(1.05);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        h1 {
            text-shadow: 0 0 10px #00ff00;
            margin-bottom: 10px;
        }
        
        #result .weather-detail {
            margin: 5px 0;
        }
    </style>

</head>
<body>
    <nav style="margin-bottom: 30px;">
        <a href="/" style="color: #00ff00; text-decoration: none; padding: 10px 20px; border: 2px solid #00ff00; margin: 0 10px; display: inline-block;">RADAR</a>
        <a href="/wiki" style="color: #00ff00; text-decoration: none; padding: 10px 20px; border: 2px solid #00ff00; margin: 0 10px; display: inline-block;">WIKI</a>
        <a href="/map" style="color: #00ff00; text-decoration: none; padding: 10px 20px; border: 2px solid #00ff00; margin: 0 10px; display: inline-block;">MAP</a>
    </nav>
    
    <h1>RDA SECTOR SCANNER - RADAR</h1>
    <p>Select a sector to scan for weather conditions</p>
    
    <div id="result">Waiting for data...</div>

    <button onclick="scanSector('hallelujah_mountains')">ğŸ”ï¸ SCAN SECTOR: MOUNTAINS</button>
    <button onclick="scanSector('eastern_sea')">ğŸŒŠ SCAN SECTOR: REEF</button>

    <script>
        async function scanSector(sectorKey) {
            const resultDiv = document.getElementById("result");
            const buttons = document.querySelectorAll("button");
            
            buttons.forEach(btn => btn.disabled = true);
            
            resultDiv.innerText = "CONNECTING TO SATELLITE...\nEstablishing link...";
            
            try {
                const response = await fetch('/get_weather/' + sectorKey);
                
                if (response.ok) {
                    const data = await response.json();
                    
                    let resultText = `SECTOR: ${data.location}\n`;
                    resultText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                    resultText += `TEMPERATURE: ${data.temp}Â°C\n`;
                    resultText += `WIND SPEED: ${data.wind} km/h\n`;
                    
                    if (data.wind_direction) {
                        resultText += `WIND DIRECTION: ${data.wind_direction}Â°\n`;
                    }
                    if (data.humidity !== null && data.humidity !== undefined) {
                        resultText += `HUMIDITY: ${data.humidity}%\n`;
                    }
                    if (data.pressure) {
                        resultText += `PRESSURE: ${data.pressure} hPa\n`;
                    }
                    
                    resultText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                    
                    resultDiv.innerHTML = resultText + 
                        `<span class="status" style="color: ${data.status_color};">` +
                        `STATUS: ${data.status}` +
                        `</span>`;
                    
                    document.body.style.backgroundImage = `url('${data.image}')`;
                    
                } else {
                    let errorMessage = "SIGNAL LOST";
                    try {
                        const errorData = await response.json();
                        errorMessage = errorData.message || errorData.error || errorMessage;
                    } catch (e) {
                        errorMessage = `ERROR ${response.status}: ${response.statusText}`;
                    }
                    
                    resultDiv.innerText = `${errorMessage}\n\nPlease try again later.`;
                    resultDiv.style.borderColor = "#ff0000";
                }
                
            } catch (error) {
                console.error("Scan error:", error);
                resultDiv.innerText = `NETWORK ERROR\n\nFailed to connect to satellite.\nError: ${error.message}`;
                resultDiv.style.borderColor = "#ff0000";
            } finally {
                buttons.forEach(btn => btn.disabled = false);
            }
        }
    </script>

</body>
</html>
